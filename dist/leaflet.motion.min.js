/*!
 * 
 *  leaflet.motion - v0.0.5 (https://github.com/Igor-Vladyka/leaflet.motion#readme) 
 *  Leaflet plugin that allow to animate line leaflet map objects
 *  
 *  MIT (http://www.opensource.org/licenses/mit-license.php)
 *  (c) 2018  Igor Vladyka <igor.vladyka@gmail.com> (https://github.com/Igor-Vladyka/)
 * 
 */!function(t){var n={};function o(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=n,o.d=function(t,n,e){o.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,n){if(1&n&&(t=o(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(o.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)o.d(e,i,function(n){return t[n]}.bind(null,i));return e},o.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(n,"a",n),n},o.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},o.p="",o(o.s=8)}([function(t,n){L.Motion.Seq=L.Motion.Group.extend({initialize:function(t,n){var o=t.length?t[0]:t;if(L.Motion.Group.prototype.initialize.call(this,[o],n),t.length)for(var e=1;e<t.length;e++)this.nextMotion(t[e])},nextMotion:function(t){var n=this.getLastLayer();return t instanceof L.Motion.Move&&(t=L.motion.polyline(t.points,t.options)),this.addLayer(t),n&&this._setupDelay(n,t),t.on(L.Motion.Event.SeqSection,this),this},startMotion:function(){var t=this.getFirstLayer();return t&&(this.fire(L.Motion.Event.SeqStarted,this),t.startMotion()),this},getFirstLayer:function(){var t=this.getLayers();return t.length?t[0]:null},getLastLayer:function(){var t=this.getLayers();return t.length?t[t.length-1]:null},_setupDelay:function(t,n){t.on(L.Motion.Event.Ended,function(t){n.startMotion()})}}),L.motion.seq=function(t,n){return new L.Motion.Seq(t,n)}},function(t,n){L.Motion.Group=L.FeatureGroup.extend({options:{pane:L.Motion.Animate.defaultOptions.pane,attribution:L.Motion.Animate.defaultOptions.attribution},initialize:function(t,n){var o=t.map(function(t){return L.motion.polyline(t.points,t.options)});L.FeatureGroup.prototype.initialize.call(this,o,n)},startMotion:function(){return this.fire(L.Motion.Event.GroupStarted),this.invoke("startMotion"),this},stopMotion:function(){return this.invoke("stopMotion"),this.fire(L.Motion.Event.GroupEnded),this},pauseMotion:function(){return this.invoke("pauseMotion"),this.fire(L.Motion.Event.GroupPaused),this},resumeMotion:function(){return this.invoke("resumeMotion"),this.fire(L.Motion.Event.GroupResumed),this},toggleMotion:function(){return this.invoke("toggleMotion"),this}}),L.motion.group=function(t,n){return new L.Motion.Group(t,n)}},function(t,n){L.Motion.Polygon=L.Polygon.extend({options:L.Motion.Animate.defaultOptions,initialize:function(t,n){this._linePoints=t[0].map(function(t){return L.Motion.Utils.toLatLng(t)}),L.Polygon.prototype.initialize.call(this,[],n)}}),L.Motion.Polygon.include(L.Motion.Animate),L.motion.polygon=function(t,n){return new L.Motion.Polygon(t,n)}},function(t,n){L.Motion.Polyline=L.Polyline.extend({options:L.Motion.Animate.defaultOptions,initialize:function(t,n){this._linePoints=t.map(function(t){return L.Motion.Utils.toLatLng(t)}),L.Polyline.prototype.initialize.call(this,[],n)},_convertToMoveObjects:function(t){return t instanceof L.Motion.Move?t:L.Util.isArray(t)?(t=t.map(function(t){return L.Motion.Utils.toLatLng(t)}),L.Motion.Move.speedMove(t,this.options.speed)):null}}),L.Motion.Polyline.include(L.Motion.Animate),L.motion.polyline=function(t,n){return new L.Motion.Polyline(t,n)}},function(t,n){L.Motion.Ease={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},easeInQuad:function(t,n,o,e,i){return e*(n/=i)*n+o},easeOutQuad:function(t,n,o,e,i){return-e*(n/=i)*(n-2)+o},easeInOutQuad:function(t,n,o,e,i){return(n/=i/2)<1?e/2*n*n+o:-e/2*(--n*(n-2)-1)+o},easeInCubic:function(t,n,o,e,i){return e*(n/=i)*n*n+o},easeOutCubic:function(t,n,o,e,i){return e*((n=n/i-1)*n*n+1)+o},easeInOutCubic:function(t,n,o,e,i){return(n/=i/2)<1?e/2*n*n*n+o:e/2*((n-=2)*n*n+2)+o},easeInQuart:function(t,n,o,e,i){return e*(n/=i)*n*n*n+o},easeOutQuart:function(t,n,o,e,i){return-e*((n=n/i-1)*n*n*n-1)+o},easeInOutQuart:function(t,n,o,e,i){return(n/=i/2)<1?e/2*n*n*n*n+o:-e/2*((n-=2)*n*n*n-2)+o},easeInQuint:function(t,n,o,e,i){return e*(n/=i)*n*n*n*n+o},easeOutQuint:function(t,n,o,e,i){return e*((n=n/i-1)*n*n*n*n+1)+o},easeInOutQuint:function(t,n,o,e,i){return(n/=i/2)<1?e/2*n*n*n*n*n+o:e/2*((n-=2)*n*n*n*n+2)+o},easeInSine:function(t,n,o,e,i){return-e*Math.cos(n/i*(Math.PI/2))+e+o},easeOutSine:function(t,n,o,e,i){return e*Math.sin(n/i*(Math.PI/2))+o},easeInOutSine:function(t,n,o,e,i){return-e/2*(Math.cos(Math.PI*n/i)-1)+o},easeInExpo:function(t,n,o,e,i){return 0==n?o:e*Math.pow(2,10*(n/i-1))+o},easeOutExpo:function(t,n,o,e,i){return n==i?o+e:e*(1-Math.pow(2,-10*n/i))+o},easeInOutExpo:function(t,n,o,e,i){return 0==n?o:n==i?o+e:(n/=i/2)<1?e/2*Math.pow(2,10*(n-1))+o:e/2*(2-Math.pow(2,-10*--n))+o},easeInCirc:function(t,n,o,e,i){return-e*(Math.sqrt(1-(n/=i)*n)-1)+o},easeOutCirc:function(t,n,o,e,i){return e*Math.sqrt(1-(n=n/i-1)*n)+o},easeInOutCirc:function(t,n,o,e,i){return(n/=i/2)<1?-e/2*(Math.sqrt(1-n*n)-1)+o:e/2*(Math.sqrt(1-(n-=2)*n)+1)+o},easeInElastic:function(t,n,o,e,i){var r=1.70158,a=0,s=e;if(0==n)return o;if(1==(n/=i))return o+e;if(a||(a=.3*i),s<Math.abs(e)){s=e;r=a/4}else r=a/(2*Math.PI)*Math.asin(e/s);return-s*Math.pow(2,10*(n-=1))*Math.sin((n*i-r)*(2*Math.PI)/a)+o},easeOutElastic:function(t,n,o,e,i){var r=1.70158,a=0,s=e;if(0==n)return o;if(1==(n/=i))return o+e;if(a||(a=.3*i),s<Math.abs(e)){s=e;r=a/4}else r=a/(2*Math.PI)*Math.asin(e/s);return s*Math.pow(2,-10*n)*Math.sin((n*i-r)*(2*Math.PI)/a)+e+o},easeInOutElastic:function(t,n,o,e,i){var r=1.70158,a=0,s=e;if(0==n)return o;if(2==(n/=i/2))return o+e;if(a||(a=i*(.3*1.5)),s<Math.abs(e)){s=e;r=a/4}else r=a/(2*Math.PI)*Math.asin(e/s);return n<1?s*Math.pow(2,10*(n-=1))*Math.sin((n*i-r)*(2*Math.PI)/a)*-.5+o:s*Math.pow(2,-10*(n-=1))*Math.sin((n*i-r)*(2*Math.PI)/a)*.5+e+o},easeInBack:function(t,n,o,e,i,r){return void 0==r&&(r=1.70158),e*(n/=i)*n*((r+1)*n-r)+o},easeOutBack:function(t,n,o,e,i,r){return void 0==r&&(r=1.70158),e*((n=n/i-1)*n*((r+1)*n+r)+1)+o},easeInOutBack:function(t,n,o,e,i,r){return void 0==r&&(r=1.70158),(n/=i/2)<1?e/2*(n*n*((1+(r*=1.525))*n-r))+o:e/2*((n-=2)*n*((1+(r*=1.525))*n+r)+2)+o},easeInBounce:function(t,n,o,e,i){return e-L.Motion.Ease.easeOutBounce(t,i-n,0,e,i)+o},easeOutBounce:function(t,n,o,e,i){return(n/=i)<1/2.75?e*(7.5625*n*n)+o:n<2/2.75?e*(7.5625*(n-=1.5/2.75)*n+.75)+o:n<2.5/2.75?e*(7.5625*(n-=2.25/2.75)*n+.9375)+o:e*(7.5625*(n-=2.625/2.75)*n+.984375)+o},easeInOutBounce:function(t,n,o,e,i){return n<i/2?.5*L.Motion.Ease.easeInBounce(t,2*n,0,e,i)+o:.5*L.Motion.Ease.easeOutBounce(t,2*n-i,0,e,i)+.5*e+o}}},function(t,n){L.Motion.Utils={interpolateOnLine:function(t,n,o){var e=(n=n instanceof L.Polyline?n.getLatLngs():n).length;if(e<2)return null;if(0===(o=Math.max(Math.min(o,1),0)))return{latLng:n[0]instanceof L.LatLng?n[0]:L.latLng(n[0]),predecessor:-1};if(1==o)return{latLng:n[n.length-1]instanceof L.LatLng?n[n.length-1]:L.latLng(n[n.length-1]),predecessor:n.length-2};var i=t.getMaxZoom();i===1/0&&(i=t.getZoom());for(var r=[],a=0,s=0;s<e;s++)r[s]=t.project(n[s],i),s>0&&(a+=r[s-1].distanceTo(r[s]));var u=a*o,l=0,c=0;for(s=0;c<u;s++){var f=r[s],h=r[s+1];l=c,c+=f.distanceTo(h)}if(void 0==f&&void 0==h)f=r[0],h=r[1],s=1;var p=c-l!=0?(u-l)/(c-l):0,M=this.interpolateOnPointSegment(f,h,p);return{latLng:t.unproject(M,i),predecessor:s-1}},interpolateOnPointSegment:function(t,n,o){return L.point(t.x*(1-o)+o*n.x,t.y*(1-o)+o*n.y)},distance:function(t){for(var n=0,o=1;o<t.length;o++)n+=t[o].distanceTo(t[o-1]);return n},getDuration:function(t,n){return n=n||this.options.speed||this.defaultOptions.speed,t=(t=t||this._linePoints).map(function(t){return L.Motion.Utils.toLatLng(t)}),L.Motion.Utils.distance(t)/(n/3600)},toLatLng:function(t,n,o){return t instanceof L.LatLng?t:L.Util.isArray(t)&&"object"!=typeof t[0]?3===t.length?L.latLng(t[0],t[1],t[2]):2===t.length?L.latLng(t[0],t[1]):null:void 0===t||null===t?t:"object"==typeof t&&"lat"in t?L.latLng(t.lat,"lng"in t?t.lng:t.lon,t.alt):void 0===n?null:L.latLng(t,n,o)}}},function(t,n){L.Motion.Move=function(t,n){if(!(t&&t.length>1))throw"please specify valid points";this.points=t.map(function(t){return L.Motion.Utils.toLatLng(t)}),this.options=n},L.motion.move=function(t,n){return new L.Motion.Move(t,n)},L.motion.move.durationMove=function(t,n,o){return(o=o||{}).duration=n,L.motion.move(t,o)},L.motion.move.speedMove=function(t,n,o){return L.motion.move.durationMove(t,L.Motion.Utils.getDuration(t,n),o)}},function(t,n){L.Motion=L.Motion||{Event:{Started:"motion-started",Paused:"motion-paused",Resumed:"motion-resumed",Section:"motion-section",Ended:"motion-ended",GroupStarted:"motion-group-stated",GroupPaused:"motion-group-paused",GroupResumed:"motion-group-resumed",GroupEnded:"motion-group-ended",SeqStarted:"motion-seq-stated",SeqPaused:"motion-seq-paused",SeqResumed:"motion-group-resumed",SeqSection:"motion-seq-section",SeqEnded:"motion-seq-ended"}},L.motion=L.motion||{},L.Motion.Animate={defaultOptions:{pane:"polymotionPane",attribution:"Leaflet.Motion Â© "+(new Date).getFullYear()+" Igor Vladyka",auto:!1,markerOptions:void 0,easing:function(t){return t},speed:60,duration:0},beforeAdd:function(t){t.getPane(this.options.pane)||(t.createPane(this.options.pane).style.zIndex=499),L.Polyline.prototype.beforeAdd.call(this,t)},onAdd:function(t){return L.Polyline.prototype.onAdd.call(this,t),this.options.auto&&this.startMotion(),this},onRemove:function(t){this.stopMotion(),L.Polyline.prototype.onRemove.call(this,t)},_motion:function(t){var n=(new Date).getTime()-t,o=n/this.options.duration;if(o<1){o=this.options.easing(o,n,0,1,this.options.duration);var e=L.Motion.Utils.interpolateOnLine(this._map,this._linePoints,o);this.addLatLng(e.latLng),this._drawMarker(e.latLng),this.__ellapsedTime=n,this.animation=L.Util.requestAnimFrame(function(){this._motion(t)},this)}else this.stopMotion(this._linePoints)},_drawMarker:function(t){var n=this.options.markerOptions;if(n)if(this.__marker){var o=this.__marker,e=o.getLatLng(),i=180*Math.atan2(t.lat-e.lat,t.lng-e.lng)/Math.PI;i<0&&(i+=360),void 0===this.options.motionMarkerOnLine||isNaN(+this.options.motionMarkerOnLine)||(this.options.motionMarkerOnLine=+this.options.motionMarkerOnLine,o._icon.children[0].style.transform="rotate(-"+Math.round(i+this.options.motionMarkerOnLine)+"deg)"),o.setLatLng(t)}else n.attribution=this.options.attribution,this.__marker=L.marker(t,n),this.__marker.addTo(this._map),this.__marker.addEventParent(this)},_validateMarker:function(){this.options.removeMarkerOnEnd&&this.__marker&&(this.__marker.remove(),this.__marker=null)},startMotion:function(){this.animation||(this.fire(L.Motion.Event.Started,this),this.setLatLngs([]),this._motion((new Date).getTime()))},stopMotion:function(t){t=t||[],this.pauseMotion(),this.setLatLngs(t),this._validateMarker(),this.__ellapsedTime=null,this.fire(L.Motion.Event.Ended,this)},pauseMotion:function(){this.animation&&(L.Util.cancelAnimFrame(this.animation),this.animation=null,this.fire(L.Motion.Event.Paused,this))},resumeMotion:function(){this.__ellapsedTime&&(this._motion((new Date).getTime()-this.__ellapsedTime),this.fire(L.Motion.Event.Resumed,this))},toggleMotion:function(){this.animation?this.pauseMotion():this.resumeMotion()}}},function(t,n,o){o(7),o(6),o(5),o(4),o(3),o(2),o(1),t.exports=o(0)}]);